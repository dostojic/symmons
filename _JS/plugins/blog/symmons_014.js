var Symmons=Symmons||{};!function($){"use strict";jQuery.fn.storeShopping=function(a){return this.each(function(){var b=Object.create(Symmons.storeShopping);b.init(this,a)})},
//Options
jQuery.fn.storeShopping.options={contentSelector2:"#stores-listing2",contentSelector3:"#stores-listing3",templateSelector2:"#template-storesListing2",templateSelector3:"#template-storesListing3",urlSelector2:jQuery("#stores-listing2").attr("data-ajax-url2"),urlSelector3:jQuery("#stores-listing3").attr("data-ajax-url"),findlocationBtnSelector:".shop-store__findlocation",modifysearchBtnSelector:".shop-store__modifysearch",preciselcoationBtnSelector:".shop-store__preciselcoation",moreLocationsBtnSelector:".stores-listing__cta",morelinksBtnSelector:".stores-listing__morelinks",noRecords:".no-records-found",scrollAmount:10,searchLocationBox:"#txtLocationSearch",magnifyGlass:"#imgMagnifybtn",storeTab1:"#storeTab1",storeTab3:"#storeTab3",isPaginationEnabled:!0,paginationObj:jQuery("#pagination-2 .pagination-content"),norecord2:"#norecord-2"},
//Product Listing
Symmons.storeShopping={init:function(a,b){var c=this;c.$container=jQuery(a),c.options=jQuery.extend({},jQuery.fn.storeShopping.options,b),c.$location="",c.$preciseLocation="",c.$searchOptions="",c.$latitude="",c.$longitude="",c.$storeType="",c.$storeLocations=[],c.$storeMoreLocations=[],c.$boundArrayList=[],c.$pageNum=1,c.$locationAddress="",c.bindHandlers(),navigator.geolocation&&jQuery(".shop-store__preciselcoation").addClass("active")},bindHandlers:function(a){var b=this;jQuery(document).on("click touchend",b.options.moreLocationsBtnSelector,function(a){a.preventDefault(),b.$storeType=jQuery(this).data("store-type"),b.bindMorelocationAjaxCall()}),jQuery(document).on("click touchend",b.options.morelinksBtnSelector,function(a){a.preventDefault(),b.$storeType=jQuery(this).data("store-type"),b.bindMorelocationAjaxCall()}),jQuery(document).on("click touchend",b.options.modifysearchBtnSelector,function(a){a.preventDefault(),b.bindShowTabActive("section-1"),b.bindHeader("section-1",""),b.bindGoogleMapsInit()}),
//Search - Text Box Enter
jQuery(document).on("keypress",b.options.searchLocationBox,function(a){13==a.keyCode&&b.validateSearchBox(this)}),jQuery(document).on("click touchend",b.options.magnifyGlass,function(a){a.preventDefault(),b.validateSearchBox(this)}),jQuery(document).on("click touchend",b.options.storeTab1,function(a){a.preventDefault(),b.bindShowTabActive("section-1"),b.bindHeader("section-1",""),b.bindGoogleMapsInit()}),jQuery(document).on("click touchend",b.options.findlocationBtnSelector,function(a){a.preventDefault(),b.validateSearchBox()}),jQuery(document).on("click touchend",b.options.preciselcoationBtnSelector,function(a){a.preventDefault(),b.bindPreciseLocation()}),google.maps.event.addDomListener(window,"load",b.bindGoogleMapsInit)},validateSearchBox:function(){var a=this,b=!1,c=jQuery("input:checked").length;jQuery(a.options.searchLocationBox).keydown(function(){jQuery(".invalid-location").hide()}),""!=jQuery(a.options.searchLocationBox).val()&&c>=1?(jQuery(".invalid-location").hide(),jQuery(".invalid-checkbox").hide(),b=!0):(""==jQuery(a.options.searchLocationBox).val()&&jQuery(".invalid-location").show(),0==c&&jQuery(".invalid-checkbox").show(),b=!1),b&&(1==c?(a.$storeType=jQuery("input[name='chkSearchOptions']:checked").val(),a.bindFindLatLongAddress("step3")):(a.$location=jQuery(a.options.searchLocationBox).val(),a.bindFindLatLongAddress("step2")))},bindFindLatLongAddress:function(a){var b=this,c="",d=new google.maps.Geocoder,e=jQuery(b.options.searchLocationBox).val();d.geocode({address:e},function(d,e){e==google.maps.GeocoderStatus.OK&&(c=new google.maps.LatLng(d[0].geometry.location.lat(),d[0].geometry.location.lng()),jQuery("#hdnLatitudeValues").val(c.lat()),jQuery("#hdnLongitudeValues").val(c.lng()),"step2"==a?b.bindLocationAjaxCall():b.bindMorelocationAjaxCall())})},bindGoogleMapLocations:function(a){var b=this,c={zoom:12,center:new google.maps.LatLng((-33.9),151.2),zoomControl:!1,zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL},mapTypeControl:!1},d=new google.maps.Map(document.getElementById("map-canvas"),c);b.$storeLocations=[],jQuery(a.StoresListingData).each(function(c,d){b.$storeLocations.push([a.StoresListingData[c].Store.StoreName,parseFloat(a.StoresListingData[c].Store.Latitude),parseFloat(a.StoresListingData[c].Store.Longitude),c+1,a.StoresListingData[c].Store.StoreMapPin])}),b.bindGoogleMarkers(d,b.$storeLocations)},bindGoogleMapMoreLocations:function(a){var b=this,c={zoom:12,center:new google.maps.LatLng((-33.9),151.2),zoomControl:!1,zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL},mapTypeControl:!1},d=new google.maps.Map(document.getElementById("map-canvas"),c);b.$storeMoreLocations=[],jQuery(a.MoreStores).each(function(c,d){b.$storeMoreLocations.push([a.MoreStores[c].StoreName,parseFloat(a.MoreStores[c].Latitude),parseFloat(a.MoreStores[c].Longitude),c+1,a.MoreStores[c].StoreMapPin])}),b.bindGoogleMarkers(d,b.$storeMoreLocations)},bindsetAllMapMarkers:function(a,b){for(var c=0;c<b.length;c++)b[c].setMap(a)},bindGoogleMarkers:function(a,b){var c=this;c.$boundArrayList=[];for(var d=0;d<b.length;d++){var e=b[d],f=new google.maps.LatLng(e[1],e[2]);c.$boundArrayList.push(new google.maps.LatLng(e[1],e[2]));new google.maps.Marker({position:f,map:a,icon:e[4],title:e[0],zIndex:e[3]})}for(var g=c.$boundArrayList,h=new google.maps.LatLngBounds,d=0,i=g.length;d<i;d++)h.extend(g[d]);a.fitBounds(h),jQuery(".store-loading-wrapper").removeClass("active")},bindPreciseLocation:function(){function a(a){var b=new google.maps.LatLng(a.coords.latitude,a.coords.longitude);e.$preciseLocation=b,jQuery("#hdnLatitudeValues").val(a.coords.latitude),jQuery("#hdnLongitudeValues").val(a.coords.longitude),e.bindCurrentLocationAdress(a.coords.latitude,a.coords.longitude)}function b(){var b=$("#geolocation-key").val()||"";return b.length?void $.post("https://www.googleapis.com/geolocation/v1/geolocate?key="+b,function(b){a({coords:{latitude:b.location.lat,longitude:b.location.lng}})}).fail(function(a){alert("API Geolocation error! \n\n"),console.log("API Geolocation Error!",a)}):void alert("No Geolocation key found!")}function c(b){a(b)}function d(a){switch(a.code){case a.TIMEOUT:alert("Browser geolocation error !\n\nTimeout.");break;case a.PERMISSION_DENIED:0==a.message.indexOf("Only secure origins are allowed")&&b();break;case a.POSITION_UNAVAILABLE:alert("Browser geolocation error !\n\nPosition unavailable.")}}var e=this,f=jQuery("input:checked").length;
// Browser doesn't support Geolocation
return 0==f?(jQuery(".invalid-checkbox").show(),!1):void(1==f?(e.$location="",e.bindFindLatLongAddress(),e.$storeType=jQuery("input[name='chkSearchOptions']:checked").val(),e.bindMorelocationAjaxCall()):(jQuery(".invalid-checkbox").hide(),navigator.geolocation?navigator.geolocation.getCurrentPosition(c,d,{maximumAge:5e4,timeout:2e4,enableHighAccuracy:!0}):e.handleNoGeolocation(!1)))},bindCurrentLocationAdress:function(a,b){var c=this,d=new google.maps.Geocoder,e=new google.maps.LatLng(a,b);c.$location="",d.geocode({latLng:e},function(a,b){b==google.maps.GeocoderStatus.OK?a[0]?(
//self.$locationAddress = results[0].formatted_address;
//sublocality
c.$currentLocality_long=a[0].address_components[3].long_name,c.$currentLocality_short=a[0].address_components[3].short_name,
//State
c.$currentState_short=a[0].address_components[5].long_name,c.$currentState_short=a[0].address_components[5].short_name,c.$locationAddress=c.$currentLocality_long+", "+c.$currentState_short,console.log(c.$locationAddress),c.bindLocationAjaxCall()):console.log("Google did not return any results."):console.log("Reverse Geocoding failed due to: ",b)})},bindGoogleMapsInit:function(a,b){/*   self.$latitude = jQuery("#hdnLatitudeValues").val();
               self.$longitude = jQuery("#hdnLongitudeValues").val();*/
function c(a){g.$latitude=a.coords.latitude,g.$longitude=a.coords.longitude;var b={zoom:15,center:new google.maps.LatLng(a.coords.latitude,a.coords.longitude),zoomControl:!1,zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL},mapTypeControl:!1},c=new google.maps.Map(document.getElementById("map-canvas"),b),d=new google.maps.LatLng(a.coords.latitude,a.coords.longitude);new google.maps.Marker({position:d,map:c});c.setCenter(d)}function d(){var a=$("#geolocation-key").val()||"";return a.length?void $.post("https://www.googleapis.com/geolocation/v1/geolocate?key="+a,function(a){c({coords:{latitude:a.location.lat,longitude:a.location.lng}})}).fail(function(a){alert("API Geolocation error! \n\n"),console.log("API Geolocation Error!",a)}):void alert("No Geolocation key found!")}function e(a){c(a)}function f(a){switch(a.code){case a.TIMEOUT:alert("Browser geolocation error !\n\nTimeout.");break;case a.PERMISSION_DENIED:0==a.message.indexOf("Only secure origins are allowed")&&d();break;case a.POSITION_UNAVAILABLE:alert("Browser geolocation error !\n\nPosition unavailable.")}}var g=this;
//geocoder = new google.maps.Geocoder();
jQuery(".shop-store__rightcols").addClass("active"),jQuery(".store-loading-wrapper").removeClass("active"),navigator.geolocation?navigator.geolocation.getCurrentPosition(e,f,{maximumAge:5e4,timeout:2e4,enableHighAccuracy:!0}):
// Browser doesn't support Geolocation
g.handleNoGeolocation(!1)},handleNoGeolocation:function(a){a?console.log("Error: The Geolocation service failed."):console.log("Error: Your browser doesn't support geolocation.")},bindCheckBoxVal:function(){var a=this,b=[];jQuery.each(jQuery("input[name='chkSearchOptions']:checked"),function(){b.push(jQuery(this).val()),a.$searchOptions=b})},bindMorelocationAjaxCall:function(){var a=this;a.$latitude=jQuery("#hdnLatitudeValues").val(),a.$longitude=jQuery("#hdnLongitudeValues").val(),
// Make the AJAX call
jQuery.ajax({url:a.options.urlSelector3+"?pageNum="+a.$pageNum+"&store="+a.$storeType+"&latitude="+a.$latitude+"&longitude="+a.$longitude,type:"GET",cache:!0,contentType:"application/json; charset=utf-8",dataType:"json",async:!0,error:function(a){console.log("Error"+a.responseText)},success:function(b){a.options.totalRecords=jQuery(b)[0].TotalRecordCount,a.options.totalPages=jQuery(b)[0].TotalPagesCount,a.options.totalRecords>0?(jQuery(a.options.noRecords).hide(),jQuery(".no-records-found").hide(),jQuery(".shop-store__rightcols").addClass("active"),jQuery(a.options.contentSelector3).show(),a.bindMoreStoresListing(b),a.options.isPaginationEnabled&&(a.bindPagination(),jQuery(a.options.contentSelector3).data("paginate").refresh(1,a.options.totalPages))):(jQuery(a.options.noRecords).show(),jQuery(".no-records-found").show(),jQuery(".shop-store__rightcols").removeClass("active"),jQuery(a.options.contentSelector3).hide(),a.options.isPaginationEnabled&&a.options.paginationObj.hide(),$loading.hide())}})},bindLocationAjaxCall:function(){var a=this;jQuery(a.options.findlocationBtnSelector).addClass("disabled"),jQuery(".store-loading-wrapper").addClass("active"),a.$latitude=jQuery("#hdnLatitudeValues").val(),a.$longitude=jQuery("#hdnLongitudeValues").val(),""==a.$location&&(a.$location=a.$locationAddress),a.bindCheckBoxVal(),
// Make the AJAX call
jQuery.ajax({url:a.options.urlSelector2+"?location="+a.$location+"&latitude="+a.$latitude+"&longitude="+a.$longitude+"&searchOptions="+a.$searchOptions,type:"GET",cache:!0,contentType:"application/json; charset=utf-8",dataType:"json",async:!0,error:function(a){console.log("Error"+a.responseText)},success:function(b){a.bindStoreTypeListing(b),jQuery(a.options.findlocationBtnSelector).removeClass("disabled")}})},bindShowTabActive:function(a){jQuery(".shop-store__leftcols").removeClass("active"),jQuery(".shop-store").attr("data-section",a),jQuery(".shop-store__leftcols[data-content='"+a+"']").addClass("active")},bindHeader:function(a,b){"section-2"==a?(jQuery(".shop-store__header").attr("style","display:table"),""!=b.LocationNearTitle&&jQuery(".shop-store__locationnear").html(b.LocationNearTitle),""!=b.LocationNear&&jQuery(".shop-store__location").html(b.LocationNear)):"section-3"==a?(jQuery(".shop-store__header").attr("style","display:table"),""!=b.LocationNearTitle&&jQuery(".shop-store__locationnear").html(b.StoreTypeName+" "+b.LocationNearTitle),""!=b.LocationNear&&jQuery(".shop-store__location").html(b.LocationNear)):jQuery(".shop-store__header").attr("style","display:none")},bindStoreTypeListing:function(data){var self=this;if(
//Math Helper
Handlebars.registerHelper("math",function(a,b,c,d){return a=parseFloat(a),c=parseFloat(c),{"+":a+c,"-":a-c,"*":a*c,"/":a/c,"%":a%c}[b]}),self.bindShowTabActive("section-2"),self.bindHeader("section-2",data),self.options.totalRecords=jQuery(data)[0].TotalRecordCount,self.options.totalRecords>0){jQuery("#norecord-2").hide(),jQuery(".shop-store__rightcols").addClass("active"),jQuery(self.options.contentSelector2).show();
//Compiler
var $container=jQuery(self.options.templateSelector2),$theTemplate=Handlebars.compile($container.html());jQuery(self.options.contentSelector2).html("").append($theTemplate(eval(data))),self.bindGoogleMapLocations(data)}else
// jQuery(self.options.noRecords).show();
jQuery("#norecord-2").show(),jQuery(".shop-store__rightcols").removeClass("active"),jQuery(self.options.contentSelector2).hide()},bindMoreStoresListing:function(data){var self=this;self.bindShowTabActive("section-3"),self.bindHeader("section-3",data),
//Math Helper
Handlebars.registerHelper("math",function(a,b,c,d){return a=parseFloat(a),c=parseFloat(c),{"+":a+c,"-":a-c,"*":a*c,"/":a/c,"%":a%c}[b]}),self.bindGoogleMapMoreLocations(data);var $container=jQuery(self.options.templateSelector3),$theTemplate=Handlebars.compile($container.html());jQuery(self.options.contentSelector3).html("").append($theTemplate(eval(data))),$loading.hide()},bindPagination:function(){var a=this;a.options.isPaginationEnabled&&("1"==a.options.totalPages?a.options.paginationObj.hide():a.options.paginationObj.show()),a.$latitude=jQuery("#hdnLatitudeValues").val(),a.$longitude=jQuery("#hdnLongitudeValues").val(),jQuery(a.options.contentSelector3).paginate({query:"pageNum",pagerData:"pager",pageData:"page-1",next:"next",prev:"prev",first:"first",last:"last",pageInput:$(".pagination__input_1"),updatePagerState:!0,totalPagesElem:$(".pagination__totalpages_1"),ajaxURLData:"ajax-url",onBefore:function(){url=new Url(jQuery(a.options.contentSelector3).attr("data-ajax-url")),url.query.store=a.$storeType,url.query.latitude=a.$latitude,url.query.longitude=a.$longitude,jQuery(a.options.contentSelector3).attr("data-ajax-url",url)},onSuccess:function(b){jQuery(a.options.contentSelector3).html(""),a.bindMoreStoresListing(b)}})}}}(jQuery);
//# sourceMappingURL=symmons_014.js.map